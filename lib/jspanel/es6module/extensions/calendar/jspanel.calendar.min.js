import{jsPanel}from"../../jspanel.js";jsPanel.calendar||(jsPanel.calendar={version:"0.1.1",date:"2020-01-27 11:36",defaults:{locale:"en",months:1,showWeekNumbers:!0,ondateselect:void 0},keyValue:void 0,weekcount:[6,10,14],daycount:[43,71,99],generateHTML(e){let a=document.createElement("div");a.className="jsPanel-cal-wrapper",a.innerHTML='<div class="jsPanel-cal-sub jsPanel-cal-blank1"></div>\n                <div class="jsPanel-cal-sub jsPanel-cal-back">&#9204;</div>\n                <div class="jsPanel-cal-sub jsPanel-cal-month"></div>\n                <div class="jsPanel-cal-sub jsPanel-cal-forward">&#9205;</div>\n                <div class="jsPanel-cal-sub jsPanel-cal-reset">&#8634;</div>\n                <div class="jsPanel-cal-sub jsPanel-cal-blank3"></div>';for(let e=0;e<7;e++)a.innerHTML+=`<div class="jsPanel-cal-sub day-name day-name-${e}"></div>`;for(let l=0;l<this.weekcount[e.months-1];l++)a.innerHTML+=`<div class="jsPanel-cal-sub week week-${l}"></div>`;for(let l=1;l<this.daycount[e.months-1];l++)a.innerHTML+=`<div class="jsPanel-cal-sub day day-${l}"></div>`;return a},unselectAllDays(e){e.querySelectorAll(".jsPanel-cal-sub.day").forEach(e=>{e.classList.remove("selected")})},create(e,a={}){let l=a;a.config&&delete(l=Object.assign({},a.config,a)).config,((l=Object.assign({},this.defaults,l)).months<1||l.months>3)&&(l.months=1),e.fill=(a=>{moment.locale(l.locale);let t=a||moment();t.locale(l.locale);let n=t.month(),s=t.date(1).weekday(),d=t.localeData(),c=e.querySelector(".jsPanel-cal-month");c.innerHTML=t.format("MMMM YYYY"),c.dataset.date=t.format("YYYY-MM-DD");let o=e.querySelectorAll(".jsPanel-cal-sub.day-name"),r=d.weekdaysMin();if(1===d.firstDayOfWeek()){for(let e=0,a=1;e<7;e++,a++)o[e].textContent=r[a];o[6].textContent=r[0],o[5].classList.add("weekend"),o[6].classList.add("weekend")}else{for(let e=0;e<7;e++)o[e].textContent=r[e];o[0].classList.add("weekend"),o[6].classList.add("weekend")}let i=t.subtract(++s,"days");e.querySelectorAll(".jsPanel-cal-sub.day").forEach(e=>{e.classList.remove("today","notInMonth");let a=i.add(1,"days");e.textContent=a.format("D"),e.dataset.date=t.format("YYYY-MM-DD"),a.month()!==n?e.classList.add("notInMonth"):e.dataset.date===moment().format("YYYY-MM-DD")&&e.classList.add("today")}),l.showWeekNumbers?e.querySelectorAll(".jsPanel-cal-sub.week").forEach((a,l)=>{a.textContent=moment(e.querySelector(`.jsPanel-cal-sub.day-${7*(l+1)}`).dataset.date).week()}):e.querySelector(".jsPanel-cal-wrapper").style.gridTemplateColumns="0fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr"});let t=this.generateHTML(l);t.classList.add(`month-count-${l.months}`),e.append(t),e.fill();let n=e.querySelector(".jsPanel-cal-sub.jsPanel-cal-month");return jsPanel.pointerdown.forEach(a=>{e.querySelector(".jsPanel-cal-sub.jsPanel-cal-back").addEventListener(a,a=>{a.preventDefault();let l=jsPanel.calendar.keyValue||1;e.fill(moment(n.dataset.date).subtract(l,"months"))},!1)}),jsPanel.pointerdown.forEach(a=>{e.querySelector(".jsPanel-cal-sub.jsPanel-cal-forward").addEventListener(a,a=>{a.preventDefault();let l=jsPanel.calendar.keyValue||1;e.fill(moment(n.dataset.date).add(l,"months"))},!1)}),jsPanel.pointerdown.forEach(a=>{e.querySelector(".jsPanel-cal-sub.jsPanel-cal-reset").addEventListener(a,a=>{a.preventDefault(),e.fill(moment())},!1)}),jsPanel.pointerdown.forEach(e=>{t.addEventListener(e,e=>{const a=e.target,n=e.altKey,s=e.ctrlKey,d=e.shiftKey;if(e.preventDefault(),a.classList.contains("day")){let c=a.dataset.date;if(s||d||n||jsPanel.calendar.unselectAllDays(t),l.ondateselect&&"function"==typeof l.ondateselect){let a=moment(c);l.ondateselect.call(a,a,e)}}},!1)}),e}},document.addEventListener("keydown",e=>{e.key.match(/^[2-9]$/)?jsPanel.calendar.keyValue=e.key:e.key.match(/^1$/)&&(jsPanel.calendar.keyValue=12)}),document.addEventListener("keyup",()=>{jsPanel.calendar.keyValue=void 0}));